<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.37">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>PSYC 575 Multilevel Modeling (2022 Fall) - R Codes (Refresher)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

<script src="../site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="../site_libs/pagedtable-1.1/js/pagedtable.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">PSYC 575 Multilevel Modeling (2022 Fall)</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html">Home</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../syllabus.html">Syllabus</a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-modules" role="button" data-bs-toggle="dropdown" aria-expanded="false">Modules</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-modules">    
        <li>
    <a class="dropdown-item" href="../modules/week1.html">
 <span class="dropdown-text">Week 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../modules/week1b.html">
 <span class="dropdown-text">Regression Refresher</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-r-code" role="button" data-bs-toggle="dropdown" aria-expanded="false">R code</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-r-code">    
        <li>
    <a class="dropdown-item" href="../codes/rcode1.html">
 <span class="dropdown-text">R Codes (Week 1)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../codes/rcode1b.html">
 <span class="dropdown-text">R Codes (Refresher)</span></a>
  </li>  
    </ul>
  </li>
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">R Codes (Refresher)</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../codes/rcode1.html" class="sidebar-item-text sidebar-link">R Codes (Week 1)</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../codes/rcode1b.html" class="sidebar-item-text sidebar-link active">R Codes (Refresher)</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#load-packages-and-import-data" id="toc-load-packages-and-import-data" class="nav-link active" data-scroll-target="#load-packages-and-import-data">Load Packages and Import Data</a>
  <ul class="collapse">
  <li><a href="#import-data" id="toc-import-data" class="nav-link" data-scroll-target="#import-data">Import Data</a></li>
  </ul></li>
  <li><a href="#quick-scatterplot-matrix" id="toc-quick-scatterplot-matrix" class="nav-link" data-scroll-target="#quick-scatterplot-matrix">Quick Scatterplot Matrix</a></li>
  <li><a href="#linear-regression-of-salary-on-pub" id="toc-linear-regression-of-salary-on-pub" class="nav-link" data-scroll-target="#linear-regression-of-salary-on-pub">1. Linear Regression of <code>salary</code> on <code>pub</code></a>
  <ul class="collapse">
  <li><a href="#visualize-the-data" id="toc-visualize-the-data" class="nav-link" data-scroll-target="#visualize-the-data">Visualize the data</a></li>
  <li><a href="#linear-regression" id="toc-linear-regression" class="nav-link" data-scroll-target="#linear-regression">Linear regression</a></li>
  <li><a href="#visualize-fitted-regression-line" id="toc-visualize-fitted-regression-line" class="nav-link" data-scroll-target="#visualize-fitted-regression-line">Visualize fitted regression line:</a></li>
  <li><a href="#confidence-intervals" id="toc-confidence-intervals" class="nav-link" data-scroll-target="#confidence-intervals">Confidence intervals</a></li>
  <li><a href="#interpretations" id="toc-interpretations" class="nav-link" data-scroll-target="#interpretations">Interpretations</a></li>
  <li><a href="#centering" id="toc-centering" class="nav-link" data-scroll-target="#centering">Centering</a></li>
  </ul></li>
  <li><a href="#categorical-predictor" id="toc-categorical-predictor" class="nav-link" data-scroll-target="#categorical-predictor">2. Categorical Predictor</a>
  <ul class="collapse">
  <li><a href="#equivalence-to-the-t-test" id="toc-equivalence-to-the-t-test" class="nav-link" data-scroll-target="#equivalence-to-the-t-test">Equivalence to the <span class="math inline">\(t\)</span>-test</a></li>
  </ul></li>
  <li><a href="#multiple-predictors-multiple-regression" id="toc-multiple-predictors-multiple-regression" class="nav-link" data-scroll-target="#multiple-predictors-multiple-regression">3. Multiple Predictors (Multiple Regression)</a>
  <ul class="collapse">
  <li><a href="#plotting" id="toc-plotting" class="nav-link" data-scroll-target="#plotting">Plotting</a></li>
  <li><a href="#interpretations-1" id="toc-interpretations-1" class="nav-link" data-scroll-target="#interpretations-1">Interpretations</a></li>
  <li><a href="#diagnostics" id="toc-diagnostics" class="nav-link" data-scroll-target="#diagnostics">Diagnostics</a></li>
  <li><a href="#effect-size" id="toc-effect-size" class="nav-link" data-scroll-target="#effect-size">Effect size</a></li>
  </ul></li>
  <li><a href="#interaction" id="toc-interaction" class="nav-link" data-scroll-target="#interaction">4. Interaction</a>
  <ul class="collapse">
  <li><a href="#interaction-plots" id="toc-interaction-plots" class="nav-link" data-scroll-target="#interaction-plots">Interaction Plots</a></li>
  </ul></li>
  <li><a href="#tabulate-the-regression-results" id="toc-tabulate-the-regression-results" class="nav-link" data-scroll-target="#tabulate-the-regression-results">5. Tabulate the Regression Results</a></li>
  <li><a href="#bonus-matrix-form-of-regression" id="toc-bonus-matrix-form-of-regression" class="nav-link" data-scroll-target="#bonus-matrix-form-of-regression">Bonus: Matrix Form of Regression</a></li>
  <li><a href="#bonus-more-options-in-formatting-tables" id="toc-bonus-more-options-in-formatting-tables" class="nav-link" data-scroll-target="#bonus-more-options-in-formatting-tables">Bonus: More Options in Formatting Tables</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title d-none d-lg-block">R Codes (Refresher)</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source" data-quarto-source-url="rmd/week1-review-regression.Rmd"><i class="bi"></i> Download Rmd</button></div></div>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<p>Click here to download the Rmd file: <a href="rmd/week1b-review-regression.Rmd">week1b-review-regression.Rmd</a></p>
<section id="load-packages-and-import-data" class="level2">
<h2 class="anchored" data-anchor-id="load-packages-and-import-data">Load Packages and Import Data</h2>
<p>You can use add the <code>message = FALSE</code> option to suppress the package loading messages</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># To install a package, run the following ONCE (and only once on your computer)</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("psych")</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych, <span class="at">include.only =</span> <span class="st">"pairs.panels"</span>) <span class="co"># for scatterplot matrix</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here) <span class="co"># makes reading data more consistent</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># for data manipulation and plotting</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car) <span class="co"># some useful functions for regression</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelsummary) <span class="co"># for making tables</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjPlot) <span class="co"># for plotting slopes</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(interactions) <span class="co"># for plotting interactions</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="import-data" class="level3">
<h3 class="anchored" data-anchor-id="import-data">Import Data</h3>
<p>First, download the data file <code>salary.txt</code> from <a href="https://raw.githubusercontent.com/marklhc/marklai-pages/master/data_files/salary.txt" class="uri">https://raw.githubusercontent.com/marklhc/marklai-pages/master/data_files/salary.txt</a>, and import the data. A robust way to do so is to download the data to a folder called <code>data_files</code> under the project directory, and then use the <code>here</code> package. This avoids a lot of data import issues that I’ve seen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The `here()` function forces the use of the project directory</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">here</span>(<span class="st">"data_files"</span>, <span class="st">"salary.txt"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in the data</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>salary_dat <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="fu">here</span>(<span class="st">"data_files"</span>, <span class="st">"salary.txt"</span>), <span class="at">header =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Alternatively, from the menu, click <code>File</code> → <code>Import Dataset</code> → <code>From Text (base)...</code>, and select the file.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the data</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>salary_dat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["id"],"name":[1],"type":["int"],"align":["right"]},{"label":["time"],"name":[2],"type":["int"],"align":["right"]},{"label":["pub"],"name":[3],"type":["int"],"align":["right"]},{"label":["sex"],"name":[4],"type":["int"],"align":["right"]},{"label":["citation"],"name":[5],"type":["int"],"align":["right"]},{"label":["salary"],"name":[6],"type":["int"],"align":["right"]}],"data":[{"1":"1","2":"3","3":"18","4":"1","5":"50","6":"51876"},{"1":"2","2":"6","3":"3","4":"1","5":"26","6":"54511"},{"1":"3","2":"3","3":"2","4":"1","5":"50","6":"53425"},{"1":"4","2":"8","3":"17","4":"0","5":"34","6":"61863"},{"1":"5","2":"9","3":"11","4":"1","5":"41","6":"52926"},{"1":"6","2":"6","3":"6","4":"0","5":"37","6":"47034"},{"1":"7","2":"16","3":"38","4":"0","5":"48","6":"66432"},{"1":"8","2":"10","3":"48","4":"0","5":"56","6":"61100"},{"1":"9","2":"2","3":"9","4":"0","5":"19","6":"41934"},{"1":"10","2":"5","3":"22","4":"0","5":"29","6":"47454"},{"1":"11","2":"5","3":"30","4":"1","5":"28","6":"49832"},{"1":"12","2":"6","3":"21","4":"0","5":"31","6":"47047"},{"1":"13","2":"7","3":"10","4":"1","5":"25","6":"39115"},{"1":"14","2":"11","3":"27","4":"0","5":"40","6":"59677"},{"1":"15","2":"18","3":"37","4":"0","5":"61","6":"61458"},{"1":"16","2":"6","3":"8","4":"0","5":"32","6":"54528"},{"1":"17","2":"9","3":"13","4":"1","5":"36","6":"60327"},{"1":"18","2":"7","3":"6","4":"0","5":"69","6":"56600"},{"1":"19","2":"7","3":"12","4":"1","5":"47","6":"52542"},{"1":"20","2":"3","3":"29","4":"1","5":"29","6":"50455"},{"1":"21","2":"7","3":"29","4":"1","5":"35","6":"51647"},{"1":"22","2":"5","3":"7","4":"0","5":"35","6":"62895"},{"1":"23","2":"7","3":"6","4":"0","5":"18","6":"53740"},{"1":"24","2":"13","3":"69","4":"0","5":"90","6":"75822"},{"1":"25","2":"5","3":"11","4":"0","5":"60","6":"56596"},{"1":"26","2":"8","3":"9","4":"1","5":"30","6":"55682"},{"1":"27","2":"8","3":"20","4":"1","5":"27","6":"62091"},{"1":"28","2":"7","3":"41","4":"1","5":"35","6":"42162"},{"1":"29","2":"2","3":"3","4":"1","5":"14","6":"52646"},{"1":"30","2":"13","3":"27","4":"0","5":"56","6":"74199"},{"1":"31","2":"5","3":"14","4":"0","5":"50","6":"50729"},{"1":"32","2":"3","3":"23","4":"0","5":"25","6":"70011"},{"1":"33","2":"1","3":"1","4":"0","5":"35","6":"37939"},{"1":"34","2":"3","3":"7","4":"0","5":"1","6":"39652"},{"1":"35","2":"9","3":"19","4":"0","5":"69","6":"68987"},{"1":"36","2":"3","3":"11","4":"0","5":"69","6":"55579"},{"1":"37","2":"9","3":"31","4":"0","5":"27","6":"54671"},{"1":"38","2":"3","3":"9","4":"0","5":"50","6":"57704"},{"1":"39","2":"4","3":"12","4":"1","5":"32","6":"44045"},{"1":"40","2":"10","3":"32","4":"0","5":"33","6":"51122"},{"1":"41","2":"1","3":"26","4":"0","5":"45","6":"47082"},{"1":"42","2":"11","3":"12","4":"0","5":"54","6":"60009"},{"1":"43","2":"5","3":"9","4":"0","5":"47","6":"58632"},{"1":"44","2":"1","3":"6","4":"0","5":"29","6":"38340"},{"1":"45","2":"21","3":"39","4":"0","5":"69","6":"71219"},{"1":"46","2":"7","3":"16","4":"1","5":"47","6":"53712"},{"1":"47","2":"5","3":"12","4":"1","5":"43","6":"54782"},{"1":"48","2":"16","3":"50","4":"0","5":"55","6":"83503"},{"1":"49","2":"5","3":"18","4":"0","5":"33","6":"47212"},{"1":"50","2":"4","3":"16","4":"1","5":"28","6":"52840"},{"1":"51","2":"5","3":"5","4":"0","5":"42","6":"53650"},{"1":"52","2":"11","3":"20","4":"0","5":"24","6":"50931"},{"1":"53","2":"16","3":"50","4":"1","5":"31","6":"66784"},{"1":"54","2":"3","3":"6","4":"1","5":"27","6":"49751"},{"1":"55","2":"4","3":"19","4":"1","5":"83","6":"74343"},{"1":"56","2":"4","3":"11","4":"1","5":"49","6":"57710"},{"1":"57","2":"5","3":"13","4":"0","5":"14","6":"52676"},{"1":"58","2":"6","3":"3","4":"1","5":"36","6":"41195"},{"1":"59","2":"4","3":"8","4":"1","5":"34","6":"45662"},{"1":"60","2":"8","3":"11","4":"1","5":"70","6":"47606"},{"1":"61","2":"3","3":"25","4":"1","5":"27","6":"44301"},{"1":"62","2":"4","3":"4","4":"1","5":"28","6":"58582"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>You can see the description of the variables here: <a href="https://rdrr.io/cran/MBESS/man/prof.salary.html" class="uri">https://rdrr.io/cran/MBESS/man/prof.salary.html</a></p>
</section>
</section>
<section id="quick-scatterplot-matrix" class="level2">
<h2 class="anchored" data-anchor-id="quick-scatterplot-matrix">Quick Scatterplot Matrix</h2>
<p>Import to screen your data before any statistical modeling</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs.panels</span>(salary_dat[, <span class="sc">-</span><span class="dv">1</span>], <span class="co"># not plotting the first column</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">ellipses =</span> <span class="cn">FALSE</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="rcode1b_files/figure-html/pairs-salary_dat-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="linear-regression-of-salary-on-pub" class="level2">
<h2 class="anchored" data-anchor-id="linear-regression-of-salary-on-pub">1. Linear Regression of <code>salary</code> on <code>pub</code></h2>
<section id="visualize-the-data" class="level3">
<h3 class="anchored" data-anchor-id="visualize-the-data">Visualize the data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the data ("gg" stands for grammar of graphics)</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    salary_dat, <span class="co"># specify data</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># aesthetics: mapping variable to axes)</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> pub, <span class="at">y =</span> salary)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># geom: geometric objects, such as points, lines, shapes, etc</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>()</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a smoother geom to visualize mean salary as a function of pub</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> <span class="fu">geom_smooth</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>&gt;# `geom_smooth()` using method = 'loess' and formula 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="rcode1b_files/figure-html/p1-smooth-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>A little bit of non-linearity on the plot. Now fit the regression model</p>
</section>
<section id="linear-regression" class="level3">
<h3 class="anchored" data-anchor-id="linear-regression">Linear regression</h3>
<p>You can type equations (with LaTeX; see a <a href="https://www.latex-tutorial.com/tutorials/amsmath/">quick reference</a>).</p>
<p>P.S. Use <code>\text{}</code> to specify variable names</p>
<p>P.S. Pay attention to the subscripts</p>
<p><span class="math display">\[\text{salary}_i = \beta_0 + \beta_1 \text{pub}_i + e_i\]</span></p>
<ul>
<li>Outcome: <code>salary</code></li>
<li>Predictor: <code>pub</code></li>
<li><span class="math inline">\(\beta_0\)</span>: regression intercept</li>
<li><span class="math inline">\(\beta_1\)</span>: regression slope</li>
<li><span class="math inline">\(e\)</span>: error</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># left hand side of ~ is outcome; right hand side contains predictors</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co"># salary ~ (beta_0) * 1 + (beta_1) * pub</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># remove beta_0 and beta_1 to get the formula</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(salary <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> pub, <span class="at">data =</span> salary_dat)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># In R, the output is not printed out if it is saved to an object (e.g., m1).</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary:</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;# 
&gt;# Call:
&gt;# lm(formula = salary ~ 1 + pub, data = salary_dat)
&gt;# 
&gt;# Residuals:
&gt;#      Min       1Q   Median       3Q      Max 
&gt;# -20660.0  -7397.5    333.7   5313.9  19238.7 
&gt;# 
&gt;# Coefficients:
&gt;#             Estimate Std. Error t value Pr(&gt;|t|)    
&gt;# (Intercept) 48439.09    1765.42  27.438  &lt; 2e-16 ***
&gt;# pub           350.80      77.17   4.546 2.71e-05 ***
&gt;# ---
&gt;# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
&gt;# 
&gt;# Residual standard error: 8440 on 60 degrees of freedom
&gt;# Multiple R-squared:  0.2562, Adjusted R-squared:  0.2438 
&gt;# F-statistic: 20.67 on 1 and 60 DF,  p-value: 2.706e-05</code></pre>
</div>
</div>
</section>
<section id="visualize-fitted-regression-line" class="level3">
<h3 class="anchored" data-anchor-id="visualize-fitted-regression-line">Visualize fitted regression line:</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Non-parametric fit</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Linear regression line (in red)</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>&gt;# `geom_smooth()` using method = 'loess' and formula 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>&gt;# `geom_smooth()` using formula 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="rcode1b_files/figure-html/p1-fitted-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="confidence-intervals" class="level3">
<h3 class="anchored" data-anchor-id="confidence-intervals">Confidence intervals</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Confidence intervals</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;#                 2.5 %     97.5 %
&gt;# (Intercept) 44907.729 51970.4450
&gt;# pub           196.441   505.1625</code></pre>
</div>
</div>
</section>
<section id="interpretations" class="level3">
<h3 class="anchored" data-anchor-id="interpretations">Interpretations</h3>
<blockquote class="blockquote">
<p>Based on our model, faculty with one more publication have predicted salary of $350.8, 95% CI [$196.4, $505.2], higher than those with one less publication.</p>
</blockquote>
<p>But what do the confidence intervals and the standard errors mean? To understanding what exactly a regression model is, let’s run some simulations.</p>
</section>
<section id="centering" class="level3">
<h3 class="anchored" data-anchor-id="centering">Centering</h3>
<p>So that the intercept refers to a more meaningful value. It’s a major issue in multilevel modeling.</p>
<p><span class="math display">\[\text{salary}_i = \beta_0 + \beta_1 \text{pub}^c_i + e_i\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using pipe operator</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>salary_dat <span class="ot">&lt;-</span> salary_dat <span class="sc">%&gt;%</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">pub_c =</span> pub <span class="sc">-</span> <span class="fu">mean</span>(pub))</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Equivalent to:</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co"># salary_dat &lt;- mutate(salary_dat,</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co">#                      pub_c = pub - mean(pub))</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>m1c <span class="ot">&lt;-</span> <span class="fu">lm</span>(salary <span class="sc">~</span> pub_c, <span class="at">data =</span> salary_dat)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;# 
&gt;# Call:
&gt;# lm(formula = salary ~ pub_c, data = salary_dat)
&gt;# 
&gt;# Residuals:
&gt;#      Min       1Q   Median       3Q      Max 
&gt;# -20660.0  -7397.5    333.7   5313.9  19238.7 
&gt;# 
&gt;# Coefficients:
&gt;#             Estimate Std. Error t value Pr(&gt;|t|)    
&gt;# (Intercept) 54815.76    1071.93  51.137  &lt; 2e-16 ***
&gt;# pub_c         350.80      77.17   4.546 2.71e-05 ***
&gt;# ---
&gt;# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
&gt;# 
&gt;# Residual standard error: 8440 on 60 degrees of freedom
&gt;# Multiple R-squared:  0.2562, Adjusted R-squared:  0.2438 
&gt;# F-statistic: 20.67 on 1 and 60 DF,  p-value: 2.706e-05</code></pre>
</div>
</div>
<p>The only change is the intercept coefficient</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">col =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Intercept without centering</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">col =</span> <span class="st">"Not centered"</span>, <span class="at">xintercept =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Intercept with centering</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">col =</span> <span class="st">"Centered"</span>, <span class="at">xintercept =</span> <span class="fu">mean</span>(salary_dat<span class="sc">$</span>pub))) <span class="sc">+</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">col =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>&gt;# `geom_smooth()` using formula 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="rcode1b_files/figure-html/p1-center-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="categorical-predictor" class="level2">
<h2 class="anchored" data-anchor-id="categorical-predictor">2. Categorical Predictor</h2>
<p>Recode <code>sex</code> as <code>factor</code> variable in R (which allows R to automatically do dummy coding). This should be done in general for categorical predictors.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>salary_dat <span class="ot">&lt;-</span> salary_dat <span class="sc">%&gt;%</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sex =</span> <span class="fu">factor</span>(sex,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"male"</span>, <span class="st">"female"</span>)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><span class="math display">\[\text{salary}_i = \beta_0 + \beta_1 \text{sex}_i + e_i\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>(p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(salary_dat, <span class="fu">aes</span>(<span class="at">x =</span> sex, <span class="at">y =</span> salary)) <span class="sc">+</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_jitter</span>(<span class="at">height =</span> <span class="dv">0</span>, <span class="at">width =</span> <span class="fl">0.1</span>)) <span class="co"># move the points to left/right a bit</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="rcode1b_files/figure-html/p2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(salary <span class="sc">~</span> sex, <span class="at">data =</span> salary_dat)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;# 
&gt;# Call:
&gt;# lm(formula = salary ~ sex, data = salary_dat)
&gt;# 
&gt;# Residuals:
&gt;#    Min     1Q Median     3Q    Max 
&gt;# -18576  -5736    -19   4853  26988 
&gt;# 
&gt;# Coefficients:
&gt;#             Estimate Std. Error t value Pr(&gt;|t|)    
&gt;# (Intercept)    56515       1620  34.875   &lt;2e-16 ***
&gt;# sexfemale      -3902       2456  -1.589    0.117    
&gt;# ---
&gt;# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
&gt;# 
&gt;# Residual standard error: 9587 on 60 degrees of freedom
&gt;# Multiple R-squared:  0.04039,    Adjusted R-squared:  0.02439 
&gt;# F-statistic: 2.525 on 1 and 60 DF,  p-value: 0.1173</code></pre>
</div>
</div>
<p>The <code>(Intercept)</code> coefficient is for the ‘0’ category, i.e., predicted salary for males; the <code>female</code> coefficient is the difference between males and females.</p>
<p>Predicted female salary = 56515 + (-3902) = 52613.</p>
<section id="equivalence-to-the-t-test" class="level3">
<h3 class="anchored" data-anchor-id="equivalence-to-the-t-test">Equivalence to the <span class="math inline">\(t\)</span>-test</h3>
<p>When assuming homogeneity of variance</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(salary <span class="sc">~</span> sex, <span class="at">data =</span> salary_dat, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;# 
&gt;#  Two Sample t-test
&gt;# 
&gt;# data:  salary by sex
&gt;# t = 1.5891, df = 60, p-value = 0.1173
&gt;# alternative hypothesis: true difference in means between group male and group female is not equal to 0
&gt;# 95 percent confidence interval:
&gt;#  -1009.853  8814.041
&gt;# sample estimates:
&gt;#   mean in group male mean in group female 
&gt;#             56515.06             52612.96</code></pre>
</div>
</div>
</section>
</section>
<section id="multiple-predictors-multiple-regression" class="level2">
<h2 class="anchored" data-anchor-id="multiple-predictors-multiple-regression">3. Multiple Predictors (Multiple Regression)</h2>
<p>Now add one more predictor, <code>time</code></p>
<p><span class="math display">\[\text{salary}_i = \beta_0 + \beta_1 \text{pub}^c_i + \beta_2 \text{time}_i + e_i\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(salary_dat, <span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> salary)) <span class="sc">+</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>&gt;# `geom_smooth()` using method = 'loess' and formula 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="rcode1b_files/figure-html/p3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(salary <span class="sc">~</span> pub_c <span class="sc">+</span> time, <span class="at">data =</span> salary_dat)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m3) <span class="co"># summary</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;# 
&gt;# Call:
&gt;# lm(formula = salary ~ pub_c + time, data = salary_dat)
&gt;# 
&gt;# Residuals:
&gt;#    Min     1Q Median     3Q    Max 
&gt;# -15919  -5537   -985   4861  22476 
&gt;# 
&gt;# Coefficients:
&gt;#             Estimate Std. Error t value Pr(&gt;|t|)    
&gt;# (Intercept) 47373.38    2281.78  20.762  &lt; 2e-16 ***
&gt;# pub_c         133.00      92.73   1.434 0.156797    
&gt;# time         1096.03     303.58   3.610 0.000632 ***
&gt;# ---
&gt;# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
&gt;# 
&gt;# Residual standard error: 7703 on 59 degrees of freedom
&gt;# Multiple R-squared:  0.3908, Adjusted R-squared:  0.3701 
&gt;# F-statistic: 18.92 on 2 and 59 DF,  p-value: 4.476e-07</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(m3) <span class="co"># confidence interval</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;#                   2.5 %     97.5 %
&gt;# (Intercept) 42807.55413 51939.2044
&gt;# pub_c         -52.56216   318.5589
&gt;# time          488.56251  1703.4921</code></pre>
</div>
</div>
<p>The regression coefficients are the <em>partial</em> effects.</p>
<p><img src="https://github.com/marklhc/marklai-pages/raw/master/static/img/regression_venn.png" class="img-fluid"></p>
<section id="plotting" class="level3">
<h3 class="anchored" data-anchor-id="plotting">Plotting</h3>
<p>The <code>sjPlot::plot_model()</code> function is handy</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">plot_model</span>(m3,</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">"pred"</span>, <span class="at">show.data =</span> <span class="cn">TRUE</span>,</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">""</span> <span class="co"># remove title</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;# $pub_c</code></pre>
</div>
<div class="cell-output-display">
<p><img src="rcode1b_files/figure-html/plot-m3-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;# 
&gt;# $time</code></pre>
</div>
<div class="cell-output-display">
<p><img src="rcode1b_files/figure-html/plot-m3-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="interpretations-1" class="level3">
<h3 class="anchored" data-anchor-id="interpretations-1">Interpretations</h3>
<blockquote class="blockquote">
<p>Faculty who have worked <em>longer</em> tended to have <em>more</em> publications <strong>For faculty who graduate around the same time</strong>, a difference of 1 publication is associated with an estimated difference in salary of $133.0, 95% CI [$-52.6, $318.6], which was not significant.</p>
</blockquote>
</section>
<section id="diagnostics" class="level3">
<h3 class="anchored" data-anchor-id="diagnostics">Diagnostics</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">mmps</span>(m3) <span class="co"># marginal model plots for linearity assumptions</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="rcode1b_files/figure-html/m3-diagnostics-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The red line is the implied association based on the model, whereas the blue line is a non-parametric smoother not based on the model. If the two lines show big discrepancies (especially if in the middle), it may suggest the linearity assumptions in the model does not hold.</p>
</section>
<section id="effect-size" class="level3">
<h3 class="anchored" data-anchor-id="effect-size">Effect size</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the R^2 number (it's sometimes tricky to</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="co"># figure out whether R stores the numbers you need)</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m3)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;# [1] 0.3907761</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjusted R^2</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m3)<span class="sc">$</span>adj.r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;# [1] 0.3701244</code></pre>
</div>
</div>
<p>Proportion of predicted variance: <span class="math inline">\(R^2\)</span> = 39%, adj. <span class="math inline">\(R^2\)</span> = 37%.</p>
</section>
</section>
<section id="interaction" class="level2">
<h2 class="anchored" data-anchor-id="interaction">4. Interaction</h2>
<p>For interpretation purposes, it’s recommended to center the predictors (at least the continuous ones)</p>
<p><span class="math display">\[\text{salary}_i = \beta_0 + \beta_1 \text{pub}^c_i + \beta_2 \text{time}^c_i + \beta_3 (\text{pub}^c_i)(\text{time}^c_i) + e_i\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>salary_dat <span class="ot">&lt;-</span> salary_dat <span class="sc">%&gt;%</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">time_c =</span> time <span class="sc">-</span> <span class="fu">mean</span>(time))</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model with interactions:</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>m4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(salary <span class="sc">~</span> pub_c <span class="sc">*</span> time_c, <span class="at">data =</span> salary_dat)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m4) <span class="co"># summary</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;# 
&gt;# Call:
&gt;# lm(formula = salary ~ pub_c * time_c, data = salary_dat)
&gt;# 
&gt;# Residuals:
&gt;#    Min     1Q Median     3Q    Max 
&gt;# -14740  -5305   -373   4385  22744 
&gt;# 
&gt;# Coefficients:
&gt;#              Estimate Std. Error t value Pr(&gt;|t|)    
&gt;# (Intercept)  54238.08    1183.01  45.847  &lt; 2e-16 ***
&gt;# pub_c          104.72      98.41   1.064  0.29169    
&gt;# time_c         964.17     339.68   2.838  0.00624 ** 
&gt;# pub_c:time_c    15.07      17.27   0.872  0.38664    
&gt;# ---
&gt;# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
&gt;# 
&gt;# Residual standard error: 7719 on 58 degrees of freedom
&gt;# Multiple R-squared:  0.3987, Adjusted R-squared:  0.3676 
&gt;# F-statistic: 12.82 on 3 and 58 DF,  p-value: 1.565e-06</code></pre>
</div>
</div>
<section id="interaction-plots" class="level3">
<h3 class="anchored" data-anchor-id="interaction-plots">Interaction Plots</h3>
<p>Interpreting interaction effects is hard. Therefore,</p>
<blockquote class="blockquote">
<p>Always plot the interaction to understand the dynamics</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>interactions<span class="sc">::</span><span class="fu">interact_plot</span>(m4,</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred =</span> <span class="st">"pub_c"</span>,</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">modx =</span> <span class="st">"time_c"</span>,</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Insert specific values to plot the slopes.</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Pay attention that `time_c` has been centered</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">modx.values =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">7</span>, <span class="dv">15</span>) <span class="sc">-</span> <span class="fl">6.79</span>,</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">modx.labels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">7</span>, <span class="dv">15</span>),</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.points =</span> <span class="cn">TRUE</span>,</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x.label =</span> <span class="st">"Number of publications (mean-centered)"</span>,</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">y.label =</span> <span class="st">"Salary"</span>,</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.main =</span> <span class="st">"Time since Ph.D."</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="rcode1b_files/figure-html/interaction-plot-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Another approach is to plug in numbers to the equation:</p>
<p><span class="math display">\[\widehat{\text{salary}} = \hat \beta_0 + \hat \beta_1 \text{pub}^c + \hat \beta_2 \text{time}^c + \hat \beta_3 (\text{pub}^c)(\text{time}^c)\]</span></p>
<p>For example, consider people who’ve graduated for seven years, i.e., <code>time</code> = 7. First, be careful that in the model we have <code>time_c</code>, and <code>time</code> = 7 corresponds to <code>time_c</code> = 0.2096774 years. So if we plug that into the equation,</p>
<p><span class="math display">\[\widehat{\text{salary}} |_{\text{time} = 7} = \hat \beta_0 + \hat \beta_1 \text{pub}^c + \hat \beta_2 (0.21) + \hat \beta_3 (\text{pub}^c)(0.21)\]</span></p>
<p>Combining terms with pub<sup>c</sup>,</p>
<p><span class="math display">\[\widehat{\text{salary}} |_{\text{time} = 7} = [\hat \beta_0 + \hat \beta_2 (0.21)] + [\hat \beta_1 + \hat \beta_3 (0.21)] (\text{pub}^c)\]</span></p>
<p>Now plug in the numbers for <span class="math inline">\(\hat \beta_0\)</span>, <span class="math inline">\(\hat \beta_1\)</span>, <span class="math inline">\(\hat \beta_2\)</span>, <span class="math inline">\(\hat \beta_3\)</span>,</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># beta0 + beta2 * 0.21</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fl">54238.08</span> <span class="sc">+</span> <span class="fl">964.17</span> <span class="sc">*</span> <span class="fl">0.21</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;# [1] 54440.56</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># beta1 + beta3 * 0.21</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fl">104.72</span> <span class="sc">+</span> <span class="fl">15.07</span> <span class="sc">*</span> <span class="fl">0.21</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;# [1] 107.8847</code></pre>
</div>
</div>
<p>resulting in</p>
<p><span class="math display">\[\widehat{\text{salary}} |_{\text{time} = 7} = 54440.6 + 107.9 (\text{pub}^c), \]</span></p>
<p>which is the regression line for <code>time</code> = 7. Note, however, when an interaction is present, the regression slope will be different with a different value of <code>time</code>. So remember that</p>
<blockquote class="blockquote">
<p>An interaction means that the regression slope of a predictor depends on another predictor.</p>
</blockquote>
<p>We will further explore this in the class exercise this week.</p>
</section>
</section>
<section id="tabulate-the-regression-results" class="level2">
<h2 class="anchored" data-anchor-id="tabulate-the-regression-results">5. Tabulate the Regression Results</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">msummary</span>(<span class="fu">list</span>(</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"M1"</span> <span class="ot">=</span> m1,</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"M2"</span> <span class="ot">=</span> m2,</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"M3"</span> <span class="ot">=</span> m3,</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"M3 + Interaction"</span> <span class="ot">=</span> m4</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="at">fmt =</span> <span class="st">"%.1f"</span> <span class="co"># keep one digit</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:center;"> M1 </th>
   <th style="text-align:center;"> M2 </th>
   <th style="text-align:center;"> M3 </th>
   <th style="text-align:center;"> M3 + Interaction </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> (Intercept) </td>
   <td style="text-align:center;"> 48439.1 </td>
   <td style="text-align:center;"> 56515.1 </td>
   <td style="text-align:center;"> 47373.4 </td>
   <td style="text-align:center;"> 54238.1 </td>
  </tr>
  <tr>
   <td style="text-align:left;">  </td>
   <td style="text-align:center;"> (1765.4) </td>
   <td style="text-align:center;"> (1620.5) </td>
   <td style="text-align:center;"> (2281.8) </td>
   <td style="text-align:center;"> (1183.0) </td>
  </tr>
  <tr>
   <td style="text-align:left;"> pub </td>
   <td style="text-align:center;"> 350.8 </td>
   <td style="text-align:center;">  </td>
   <td style="text-align:center;">  </td>
   <td style="text-align:center;">  </td>
  </tr>
  <tr>
   <td style="text-align:left;">  </td>
   <td style="text-align:center;"> (77.2) </td>
   <td style="text-align:center;">  </td>
   <td style="text-align:center;">  </td>
   <td style="text-align:center;">  </td>
  </tr>
  <tr>
   <td style="text-align:left;"> sexfemale </td>
   <td style="text-align:center;">  </td>
   <td style="text-align:center;"> −3902.1 </td>
   <td style="text-align:center;">  </td>
   <td style="text-align:center;">  </td>
  </tr>
  <tr>
   <td style="text-align:left;">  </td>
   <td style="text-align:center;">  </td>
   <td style="text-align:center;"> (2455.6) </td>
   <td style="text-align:center;">  </td>
   <td style="text-align:center;">  </td>
  </tr>
  <tr>
   <td style="text-align:left;"> pub_c </td>
   <td style="text-align:center;">  </td>
   <td style="text-align:center;">  </td>
   <td style="text-align:center;"> 133.0 </td>
   <td style="text-align:center;"> 104.7 </td>
  </tr>
  <tr>
   <td style="text-align:left;">  </td>
   <td style="text-align:center;">  </td>
   <td style="text-align:center;">  </td>
   <td style="text-align:center;"> (92.7) </td>
   <td style="text-align:center;"> (98.4) </td>
  </tr>
  <tr>
   <td style="text-align:left;"> time </td>
   <td style="text-align:center;">  </td>
   <td style="text-align:center;">  </td>
   <td style="text-align:center;"> 1096.0 </td>
   <td style="text-align:center;">  </td>
  </tr>
  <tr>
   <td style="text-align:left;">  </td>
   <td style="text-align:center;">  </td>
   <td style="text-align:center;">  </td>
   <td style="text-align:center;"> (303.6) </td>
   <td style="text-align:center;">  </td>
  </tr>
  <tr>
   <td style="text-align:left;"> time_c </td>
   <td style="text-align:center;">  </td>
   <td style="text-align:center;">  </td>
   <td style="text-align:center;">  </td>
   <td style="text-align:center;"> 964.2 </td>
  </tr>
  <tr>
   <td style="text-align:left;">  </td>
   <td style="text-align:center;">  </td>
   <td style="text-align:center;">  </td>
   <td style="text-align:center;">  </td>
   <td style="text-align:center;"> (339.7) </td>
  </tr>
  <tr>
   <td style="text-align:left;"> pub_c × time_c </td>
   <td style="text-align:center;">  </td>
   <td style="text-align:center;">  </td>
   <td style="text-align:center;">  </td>
   <td style="text-align:center;"> 15.1 </td>
  </tr>
  <tr>
   <td style="text-align:left;box-shadow: 0px 1px">  </td>
   <td style="text-align:center;box-shadow: 0px 1px">  </td>
   <td style="text-align:center;box-shadow: 0px 1px">  </td>
   <td style="text-align:center;box-shadow: 0px 1px">  </td>
   <td style="text-align:center;box-shadow: 0px 1px"> (17.3) </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Num.Obs. </td>
   <td style="text-align:center;"> 62 </td>
   <td style="text-align:center;"> 62 </td>
   <td style="text-align:center;"> 62 </td>
   <td style="text-align:center;"> 62 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> R2 </td>
   <td style="text-align:center;"> 0.256 </td>
   <td style="text-align:center;"> 0.040 </td>
   <td style="text-align:center;"> 0.391 </td>
   <td style="text-align:center;"> 0.399 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> R2 Adj. </td>
   <td style="text-align:center;"> 0.244 </td>
   <td style="text-align:center;"> 0.024 </td>
   <td style="text-align:center;"> 0.370 </td>
   <td style="text-align:center;"> 0.368 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> AIC </td>
   <td style="text-align:center;"> 1301.0 </td>
   <td style="text-align:center;"> 1316.8 </td>
   <td style="text-align:center;"> 1290.6 </td>
   <td style="text-align:center;"> 1291.8 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> BIC </td>
   <td style="text-align:center;"> 1307.4 </td>
   <td style="text-align:center;"> 1323.1 </td>
   <td style="text-align:center;"> 1299.1 </td>
   <td style="text-align:center;"> 1302.4 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Log.Lik. </td>
   <td style="text-align:center;"> −647.486 </td>
   <td style="text-align:center;"> −655.383 </td>
   <td style="text-align:center;"> −641.299 </td>
   <td style="text-align:center;"> −640.895 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> RMSE </td>
   <td style="text-align:center;"> 8303.15 </td>
   <td style="text-align:center;"> 9431.02 </td>
   <td style="text-align:center;"> 7514.48 </td>
   <td style="text-align:center;"> 7465.67 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</section>
<section id="bonus-matrix-form-of-regression" class="level2">
<h2 class="anchored" data-anchor-id="bonus-matrix-form-of-regression">Bonus: Matrix Form of Regression</h2>
<p>The regression model can be represented more succintly in matrix form:</p>
<p><span class="math display">\[\mathbf y = \mathbf X \boldsymbol \beta + \mathbf e,\]</span></p>
<p>where <span class="math inline">\(\mathbf y\)</span> is a column vector (which can be considered a <span class="math inline">\(N \times 1\)</span> matrix). For example, for our data</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(salary_dat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["id"],"name":[1],"type":["int"],"align":["right"]},{"label":["time"],"name":[2],"type":["int"],"align":["right"]},{"label":["pub"],"name":[3],"type":["int"],"align":["right"]},{"label":["sex"],"name":[4],"type":["fct"],"align":["left"]},{"label":["citation"],"name":[5],"type":["int"],"align":["right"]},{"label":["salary"],"name":[6],"type":["int"],"align":["right"]},{"label":["pub_c"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["time_c"],"name":[8],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"3","3":"18","4":"female","5":"50","6":"51876","7":"-0.1774194","8":"-3.7903226","_rn_":"1"},{"1":"2","2":"6","3":"3","4":"female","5":"26","6":"54511","7":"-15.1774194","8":"-0.7903226","_rn_":"2"},{"1":"3","2":"3","3":"2","4":"female","5":"50","6":"53425","7":"-16.1774194","8":"-3.7903226","_rn_":"3"},{"1":"4","2":"8","3":"17","4":"male","5":"34","6":"61863","7":"-1.1774194","8":"1.2096774","_rn_":"4"},{"1":"5","2":"9","3":"11","4":"female","5":"41","6":"52926","7":"-7.1774194","8":"2.2096774","_rn_":"5"},{"1":"6","2":"6","3":"6","4":"male","5":"37","6":"47034","7":"-12.1774194","8":"-0.7903226","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>So</p>
<p><span class="math display">\[\mathbf y = \begin{bmatrix}
            51,876 \\
            54,511 \\
            53,425 \\
            \vdots
          \end{bmatrix}\]</span> <span class="math inline">\(\mathbf X\)</span> is the predictor matrix (sometimes also called the design matrix), where the first column is the constant 1, and each subsequent column represent a predictor. You can see this in R</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">model.matrix</span>(m3)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;#   (Intercept)       pub_c time
&gt;# 1           1  -0.1774194    3
&gt;# 2           1 -15.1774194    6
&gt;# 3           1 -16.1774194    3
&gt;# 4           1  -1.1774194    8
&gt;# 5           1  -7.1774194    9
&gt;# 6           1 -12.1774194    6</code></pre>
</div>
</div>
<p>The coefficient <span class="math inline">\(\boldsymbol \beta\)</span> is a vector, with elements <span class="math inline">\(\beta_0, \beta_1, \ldots\)</span>. The least square estimation method is used to find estimates of <span class="math inline">\(\beta\)</span> that minimizes the sum of squared differences between <span class="math inline">\(\mathbf y\)</span> and <span class="math inline">\(\mathbf X \hat{\boldsymbol \beta}\)</span>, which can be written as</p>
<p><span class="math display">\[(\mathbf y - \mathbf X \boldsymbol \beta)^\top(\mathbf y - \mathbf X \boldsymbol \beta).\]</span></p>
<p>The above means that: for each value observation, subtract the predicted value of <span class="math inline">\(y\)</span> from the observed <span class="math inline">\(y\)</span> (i.e., <span class="math inline">\(y_i - \beta_0 + \beta_1 x_{1i} + \ldots\)</span>), then squared the value (<span class="math inline">\([y_i - \beta_0 + \beta_1 x_{1i} + \ldots]^2\)</span>), then sum these squared values across observations. Or sometimes you’ll see it written as</p>
<p><span class="math display">\[\lVert\mathbf y - \mathbf X \boldsymbol \beta\rVert^2\]</span></p>
<p>It can be shown that the least square estimates can be obtained as</p>
<p><span class="math display">\[(\mathbf X^\top \mathbf X)^{-1} \mathbf X^\top \mathbf y\]</span></p>
<p>You can do the matrix form in R:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> salary_dat<span class="sc">$</span>salary</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(m3)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="co"># beta = (X'X)^{-1} X'y</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="co"># solve() is matrix inverse; t(X) is the transpose of X; use `%*%` for matrix multiplication</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>(betahat <span class="ot">&lt;-</span> <span class="fu">solve</span>(<span class="fu">t</span>(X) <span class="sc">%*%</span> X, <span class="fu">t</span>(X) <span class="sc">%*%</span> y)) <span class="co"># same as the coefficients in m3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;#                   [,1]
&gt;# (Intercept) 47373.3792
&gt;# pub_c         132.9984
&gt;# time         1096.0273</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sum of squared residual</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>((y <span class="sc">-</span> X <span class="sc">%*%</span> betahat)<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;# [1] 3500978295</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Root mean squared residual (Residual standard error)</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">sum</span>((y <span class="sc">-</span> X <span class="sc">%*%</span> betahat)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> <span class="dv">59</span>) <span class="co"># same as in R</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;# [1] 7703.156</code></pre>
</div>
</div>
</section>
<section id="bonus-more-options-in-formatting-tables" class="level2">
<h2 class="anchored" data-anchor-id="bonus-more-options-in-formatting-tables">Bonus: More Options in Formatting Tables</h2>
<p>Here’s some code you can explore to make the table output from <code>msummary()</code> to look more lik APA style (with an example here: <a href="https://apastyle.apa.org/style-grammar-guidelines/tables-figures/sample-tables#regression" class="uri">https://apastyle.apa.org/style-grammar-guidelines/tables-figures/sample-tables#regression</a>). However, for this course I don’t recommend spending too much time on tailoring the tables; something clear and readable will be good enough.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Show confidence intervals and p values</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">msummary</span>(</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Estimate"</span> <span class="ot">=</span> m4,</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">"95% CI"</span> <span class="ot">=</span> m4,</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">"p"</span> <span class="ot">=</span> m4</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate =</span> <span class="fu">c</span>(<span class="st">"estimate"</span>, <span class="st">"[{conf.low}, {conf.high}]"</span>, <span class="st">"p.value"</span>),</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">statistic =</span> <span class="cn">NULL</span>,</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># suppress gof indices (e.g., R^2)</span></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">gof_omit =</span> <span class="st">".*"</span>,</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Rename the model terms ("current name" = "new name")</span></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">coef_rename =</span> <span class="fu">c</span>(</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">"(Intercept)"</span> <span class="ot">=</span> <span class="st">"Intercept"</span>,</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>        <span class="st">"pub_c"</span> <span class="ot">=</span> <span class="st">"Number of publications"</span>,</span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>        <span class="st">"time_c"</span> <span class="ot">=</span> <span class="st">"Time since PhD"</span>,</span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>        <span class="st">"pub_c:time_c"</span> <span class="ot">=</span> <span class="st">"Publications x Time"</span></span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:center;"> Estimate </th>
   <th style="text-align:center;"> 95% CI </th>
   <th style="text-align:center;"> p </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Intercept </td>
   <td style="text-align:center;"> 54238.084 </td>
   <td style="text-align:center;"> [51870.023, 56606.145] </td>
   <td style="text-align:center;"> 0.000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Number of publications </td>
   <td style="text-align:center;"> 104.724 </td>
   <td style="text-align:center;"> [−92.273, 301.720] </td>
   <td style="text-align:center;"> 0.292 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Time since PhD </td>
   <td style="text-align:center;"> 964.170 </td>
   <td style="text-align:center;"> [284.218, 1644.122] </td>
   <td style="text-align:center;"> 0.006 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Publications x Time </td>
   <td style="text-align:center;"> 15.066 </td>
   <td style="text-align:center;"> [−19.506, 49.637] </td>
   <td style="text-align:center;"> 0.387 </td>
  </tr>
</tbody>
</table>

</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>